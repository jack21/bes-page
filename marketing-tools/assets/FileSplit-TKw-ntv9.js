import{o as i,a as F,b as _,d as N,c as q,i as w,f as n,e as t,t as g,g as r,j as $,G as J,J as K,I as W,O as X,K as Z,L as Y,r as b,$ as ee,n as P,w as C,F as M,z as te,A as le,X as ne,a4 as Q,k as A,Z as se,N as O,U as D,a5 as oe}from"./index-nLyFgQjX.js";import{_ as ae}from"./download-k__T3b8W.js";const ie={class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ce=_("path",{fill:"currentColor",d:"M13 9V3.5L18.5 9M6 2c-1.11 0-2 .89-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"},null,-1),ue=[ce];function re(V,o){return i(),F("svg",ie,[...ue])}const _e={name:"mdi-file",render:re},E=N({__name:"FileTable",props:{header:{},lines:{}},setup(V){const o=V,l=q(()=>o.lines.length);return(s,m)=>{const c=J,u=K,p=W,B=X,f=Z,k=Y;return l.value>0?(i(),w(k,{key:0,hover:"",responsive:"",bordered:"",class:"file-table"},{default:n(()=>[s.header?(i(),w(B,{key:0,variant:"light"},{default:n(()=>[t(p,null,{default:n(()=>[t(c),t(u,{class:"text-start"},{default:n(()=>[r(g(s.header),1)]),_:1})]),_:1})]),_:1})):$("",!0),t(f,null,{default:n(()=>[l.value>=1?(i(),w(p,{key:0},{default:n(()=>[t(c,{class:"text-center"},{default:n(()=>[r("1")]),_:1}),t(u,{class:"text-start"},{default:n(()=>[r(g(o.lines[0]),1)]),_:1})]),_:1})):$("",!0),l.value>=2?(i(),w(p,{key:1},{default:n(()=>[t(c,{class:"text-center"},{default:n(()=>[r("2")]),_:1}),t(u,{class:"text-start"},{default:n(()=>[r(g(o.lines[1]),1)]),_:1})]),_:1})):$("",!0),l.value>=3?(i(),w(p,{key:2},{default:n(()=>[t(c,{class:"text-center"},{default:n(()=>[r("3")]),_:1}),t(u,{class:"text-start"},{default:n(()=>[r(g(o.lines[2]),1)]),_:1})]),_:1})):$("",!0),l.value===4||l.value===5||l.value===6?(i(),w(p,{key:3},{default:n(()=>[t(c,{class:"text-center"},{default:n(()=>[r("4")]),_:1}),t(u,{class:"text-start"},{default:n(()=>[r(g(o.lines[3]),1)]),_:1})]),_:1})):$("",!0),l.value===5||l.value===6?(i(),w(p,{key:4},{default:n(()=>[t(c,{class:"text-center"},{default:n(()=>[r("5")]),_:1}),t(u,{class:"text-start"},{default:n(()=>[r(g(o.lines[4]),1)]),_:1})]),_:1})):$("",!0),l.value===6?(i(),w(p,{key:5},{default:n(()=>[t(c,{class:"text-center"},{default:n(()=>[r("6")]),_:1}),t(u,{class:"text-start"},{default:n(()=>[r(g(o.lines[5]),1)]),_:1})]),_:1})):$("",!0),l.value>=7?(i(),w(p,{key:6},{default:n(()=>[t(c,{class:"text-center"},{default:n(()=>[r("⋮")]),_:1}),t(u,{class:"text-start"},{default:n(()=>[r("⋮")]),_:1})]),_:1})):$("",!0),l.value>=7?(i(),w(p,{key:7},{default:n(()=>[t(c,{class:"text-center"},{default:n(()=>[r(g(l.value-2),1)]),_:1}),t(u,{class:"text-start"},{default:n(()=>[r(g(o.lines[l.value-3]),1)]),_:1})]),_:1})):$("",!0),l.value>=7?(i(),w(p,{key:8},{default:n(()=>[t(c,{class:"text-center"},{default:n(()=>[r(g(l.value-1),1)]),_:1}),t(u,{class:"text-start"},{default:n(()=>[r(g(o.lines[l.value-2]),1)]),_:1})]),_:1})):$("",!0),l.value>=7?(i(),w(p,{key:9},{default:n(()=>[t(c,{class:"text-center"},{default:n(()=>[r(g(l.value-0),1)]),_:1}),t(u,{class:"text-start"},{default:n(()=>[r(g(o.lines[l.value-1]),1)]),_:1})]),_:1})):$("",!0)]),_:1})]),_:1})):$("",!0)}}}),de={class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},pe=_("path",{fill:"currentColor",d:"M11 11V7h2v4zm2-10v4h-2V1zm-2 16v-4h2v4zm-2 3H6V4h3V2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h3zm6-17v5h3v12h-3v2h3c1.11 0 2-.89 2-2V8zm-2 16h-2v4h2z"},null,-1),me=[pe];function he(V,o){return i(),F("svg",de,[...me])}const ve={name:"mdi-format-page-split",render:he},fe={class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ge=_("path",{fill:"currentColor",d:"M13 11h6.95q-.37-2.75-2.29-4.66Q15.75 4.43 13 4.05m-2 15.9V4.05q-3 .38-5 2.64Q4 8.95 4 12t2 5.31q2 2.27 5 2.64m2 0q2.75-.35 4.68-2.27q1.92-1.93 2.27-4.68H13m-1 9q-2.07 0-3.9-.79q-1.82-.78-3.17-2.13q-1.35-1.35-2.14-3.18Q2 14.08 2 12t.79-3.9q.79-1.82 2.14-3.17Q6.28 3.58 8.1 2.79Q9.93 2 12 2t3.89.79q1.81.79 3.17 2.15q1.37 1.36 2.15 3.17Q22 9.93 22 12q0 2.05-.79 3.88q-.78 1.82-2.13 3.18q-1.35 1.37-3.18 2.15q-1.82.79-3.9.79"},null,-1),xe=[ge];function $e(V,o){return i(),F("svg",fe,[...xe])}const we={name:"mdi-chart-pie-outline",render:$e},Fe={class:"file-split-pieces"},ye={class:"header"},Ve={class:"split-count"},be=_("label",null,"切割份數",-1),Be={class:"control"},ke=_("span",null,"均分",-1),Ce={class:"pieces-count"},ze=_("span",null,"數量",-1),Se={class:"file-name"},He={class:"name"},qe=_("hr",null,null,-1),Ue={class:"export"},Te={class:"file-format"},Ie=_("span",null,"檔名",-1),Le=_("span",null,"匯出",-1),Ne=N({__name:"FileSplitPieces",props:{importFileName:{},encoding:{},header:{},lines:{}},setup(V){const o=V,l=b(2),s=ee([]),m=b(""),c=q(()=>o.lines),u=q(()=>o.importFileName),p=q(()=>o.importFileName.split(".").pop());P(()=>{const e=localStorage.getItem("file-split-pieces-file-count");e&&(l.value=parseInt(e,10))}),C(u,()=>{m.value=u.value.split(".")[0]}),C(l,()=>{localStorage.setItem("file-split-pieces-file-count",`${l.value}`),f()}),C(c,()=>{f()});const B=()=>{for(let e=0;e<s.length;e++){const a=s[e];typeof a=="string"&&(s[e]=parseInt(a,10))}f()},f=()=>{if(!(!o.lines||o.lines.length===0))if(console.log(`[FileSplitPieces] counts: ${s.length}`),s.length===0)d();else{const e=[];let a=0;for(let h=0;h<l.value;h++){const v=Math.max(o.lines.length-a,0);if(h===l.value-1)e.push(Math.max(v,0));else{const y=h<s.length?s[h]:0;e.push(Math.min(v,y)),a+=y}console.log(`[FileSplitPieces] counts[${h}] = ${e[e.length-1]}`)}s.splice(0),s.push(...e)}},k=e=>{if(!o.lines)return[];let a=0;for(let v=0;v<e;v++)a+=s[v];let h=a+s[e];return console.log(`[FileSplitPieces] index: ${e}, Range: ${a}~${h}`),o.lines.slice(a,h)},T=async()=>{const e=await window.showDirectoryPicker({id:"file-split-pieces"});for(let a=0;a<s.length;a++){const h=I(a),v=await e.getFileHandle(h,{create:!0}),y=(o.header?o.header+`
`:"")+k(a).join(`
`),x=ne.encode(y,o.encoding),z=new Blob([x],{type:"text/plain"}),S=await v.createWritable();await S.write(z),await S.close()}},I=e=>`${m.value}_${s.length}-${e+1}_${s[e]}.${p.value}`,d=()=>{if(s.splice(0),!o.lines)return;const e=Math.floor(o.lines.length/l.value);console.log(`[FileSplitPieces] Avg: ${e}, Lines: ${o.lines.length}, FileCount: ${l.value}`);for(let a=0;a<l.value;a++)a===l.value-1?s.push(o.lines.length-e*(l.value-1)):s.push(e),console.log(`[FileSplitPieces] counts[${a}] = ${s[s.length-1]}`)};return(e,a)=>{const h=we,v=Q,y=ve,x=A,z=se,S=E,U=_e,R=ae,j=D;return i(),F("div",Fe,[_("div",ye,[_("div",Ve,[t(h),be,t(v,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=L=>l.value=L),options:[{text:"2",value:2},{text:"3",value:3},{text:"4",value:4},{text:"5",value:5},{text:"6",value:6},{text:"7",value:7},{text:"8",value:8},{text:"9",value:9},{text:"10",value:10}],size:"sm"},null,8,["modelValue"])]),_("div",Be,[t(x,{variant:"outline-primary",size:"sm",class:"export-button",onClick:d},{default:n(()=>[t(y),ke]),_:1})])]),c.value&&c.value.length>0?(i(),F(M,{key:0},[_("div",{class:le(["pieces-tables",[`col-count-${l.value}`]])},[(i(!0),F(M,null,te(s,(L,H)=>(i(),F("div",{class:"pieces-table",key:H},[_("div",Ce,[ze,t(z,{modelValue:s[H],"onUpdate:modelValue":G=>s[H]=G,size:"sm",type:"number",onChange:B,disabled:H===s.length-1},null,8,["modelValue","onUpdate:modelValue","disabled"])]),t(S,{header:e.header,lines:k(H)},null,8,["header","lines"]),O((i(),F("div",Se,[t(U),_("span",He,g(I(H)),1)])),[[j,"檔名"]])]))),128))],2),qe,_("div",Ue,[_("div",Te,[Ie,t(z,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=L=>m.value=L),size:"sm"},null,8,["modelValue"])]),t(x,{variant:"primary",size:"sm",class:"export-button",onClick:T},{default:n(()=>[t(R),Le]),_:1})])],64)):$("",!0)])}}}),Me={class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Pe=_("path",{fill:"currentColor",d:"M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8zm4 18H6V4h7v5h5zm-8.46-4.35l2.09 2.09L10.35 19L7 15.65l3.35-3.35l1.28 1.26zm7.46 0L13.65 19l-1.27-1.26l2.09-2.09l-2.09-2.09l1.27-1.26z"},null,-1),Qe=[Pe];function Ae(V,o){return i(),F("svg",Me,[...Qe])}const Oe={name:"mdi-file-code-outline",render:Ae},De={class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ee=_("path",{fill:"currentColor",d:"M6.1 10L4 18V8h17a2 2 0 0 0-2-2h-7l-2-2H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h15c.9 0 1.7-.6 1.9-1.5l2.3-8.5zM19 18H6l1.6-6h13z"},null,-1),Re=[Ee];function je(V,o){return i(),F("svg",De,[...Re])}const Ge={name:"mdi-folder-open-outline",render:je},Je={class:"file-split-base"},Ke={class:"options"},We={class:"encoding"},Xe=N({__name:"FileSplitBase",emits:["onUpdate"],setup(V,{emit:o}){const l=o,s=b(!0),m=b("UTF-8"),c=b([]),u=b();P(()=>{const d=localStorage.getItem("file-split-encoding");d&&(m.value=d);const e=localStorage.getItem("file-split-linesHasHeader");e&&(s.value=e==="1")});const p=async()=>{const d=await I();c.value=await T(d)},B=async()=>{u.value&&(c.value=await T(u.value))},f=q(()=>s.value?c.value[0]:void 0),k=q(()=>s.value?c.value.slice(1):c.value);C(f,async()=>{var e;const d=await((e=u.value)==null?void 0:e.getFile());l("onUpdate",d==null?void 0:d.name,m.value,f.value,k.value)}),C(k,async()=>{var e;const d=await((e=u.value)==null?void 0:e.getFile());l("onUpdate",d==null?void 0:d.name,m.value,f.value,k.value)}),C(m,()=>{localStorage.setItem("file-split-encoding",m.value)}),C(s,()=>{localStorage.setItem("file-split-linesHasHeader",s.value?"1":"0")});const T=async d=>{try{const e=await d.getFile();return new Promise((a,h)=>{const v=new FileReader;v.readAsText(e,m.value),v.onload=()=>{const y=v.result;if(!y)return;const x=y.split(`
`);for(;x.length>0&&x[x.length-1].trim()==="";)x.pop();console.log(`[FileSplit] Lines: ${x.length}`),a(x)},v.onerror=()=>h("檔案讀取錯誤")})}catch(e){throw console.error("檔案選擇錯誤",e),e}},I=async()=>{const[d]=await window.showOpenFilePicker({id:"file-split-base",multiple:!1,types:[{accept:{"text/csv":[".csv"],"text/plain":[".txt"]}}]});return u.value=d,d};return(d,e)=>{const a=Ge,h=A,v=oe,y=Oe,x=Q,z=E,S=D;return i(),F("div",Je,[t(h,{variant:"primary",size:"sm",block:"",onClick:p},{default:n(()=>[t(a),r(" 開啟檔案 ")]),_:1}),_("div",Ke,[t(v,{modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=U=>s.value=U)},{default:n(()=>[r("Header")]),_:1},8,["modelValue"]),_("div",We,[O(t(y,null,null,512),[[S,"編碼方式"]]),t(x,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=U=>m.value=U),size:"sm",options:["UTF-8","Big5"],onChange:B},null,8,["modelValue"])])]),t(z,{lines:k.value,header:f.value},null,8,["lines","header"])])}}}),Ze={class:"file-split"},Ye=_("div",{class:"arrow"},">",-1),lt=N({__name:"FileSplit",setup(V){const o=b(""),l=b(""),s=b(""),m=b([]),c=(u,p,B,f)=>{o.value=u,l.value=p,s.value=B,m.value=f};return(u,p)=>{const B=Xe,f=Ne;return i(),F("div",Ze,[t(B,{onOnUpdate:c}),Ye,t(f,{"import-file-name":o.value,encoding:l.value,header:s.value,lines:m.value},null,8,["import-file-name","encoding","header","lines"])])}}});export{lt as default};
